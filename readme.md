# 0. 初期設定
## 実行環境の作成

scheduling_appフォルダを1度左クリックして選択し、再度右クリックして、「ターミナルで開く」を選択してください。  
そこで、以下のコードを実行します。
  
docker build -t schenv .

## フォルダの作成

PDFファイルを格納するフォルダを"2_Student_schedule_PDF"のなかに、"schedulePDF_result"という名前で作成してください。  

# 1. スケジュール作成手順

## 1.1 実行環境を動かす

scheduling_appフォルダを1度左クリックして選択し、再度右クリックして、「ターミナルで開く」を選択してください。  
そこで、以下のコードを実行します。

Win  
docker run -v /c/Users/shuic/Desktop/schoolie/scheduling_app:/scheduling_app -p 8501:8501 schenv

Mac  
docker run -v /Users/shu/Desktop/scheduling_app:/scheduling_app -p 8501:8501 schenv

## 1.2 ブラウザでスケジュールを実行する

以下のリンクを選択して、スケジュールを実行してください。  
  
http://localhost:8501/


# 2. 修了するとき（厳密にやらなくてもよいはず）

## 2.1 実行環境の停止

もし、さきほど開いたターミナルが開いてなければ、scheduling_appフォルダを1度左クリックして選択し、再度右クリックして、「ターミナルで開く」を選択してください。  
そこで、以下のコードを実行します。  
  
docker stop $(docker ps -q)

あとはすべてのウィンドウは閉じてしまって大丈夫です。

# 使い方

## 1_スケジュール実行フォルダを使う

1_スケジュール実行フォルダ/
    ├input/
    │   └input.xlsx
    └output/
        └output.xlsx

1_スケジュール実行フォルダの中のinputフォルダに、"input.xlsx"をファイル名をこのようにして入れる。  

input.xlsxに必須のシートは以下の4つ。

- 生徒_受講コマ数  
    これは、「生徒の名前、受講するコマ数（科目ごと）、希望する先生、生徒の優先順位」を入力する。必ず入力しないといけない列は、「生徒の優先順位、生徒の名前、受講するコマ数」である。希望する先生を入力しなかった場合は、未定となる。また、後述する「先生スケジュールシート」に名前のない先生の名前を書いても、エラーとなってしまう。

- 座席上限  
    これは、教室へ入れる先生の数の容量である。もし、教室を休みにする日や時間があれば、その日付時限のセルは0にする。また、前半のAコマBコマは先生の数を少なくしておければ、3と打ち込むと先生が3人までしか入らないようにスケジュールが組まれる。  
    塾の開講日、時間のスケジュールを入力してほしい。

- 先生スケジュール
    講習期間の先生のスケジュールである。１人の先生が2人の生徒を見れることを考えて、その日、時限に来れるセルに2と入力する。もし、先生の能力的に1人だけ任せる場合は、1と入力すれば良い。また、この先生に特定の時間に入って欲しくなければその時間を0にする。

- 生徒スケジュール  
    講習期間の生徒のスケジュールである。打ち込むのがとても大変であり、改善が必要だとは感じる。

これらの情報を、入力して、  1.1 実行環境を動かす　の手順を実行し、以下のリンクへ飛べば、スケジュールを実行するボタンが現れる。
  
http://localhost:8501/  
  

## スケジュールの組み直し

上の手順を踏んで、スケジュールを組み終わると、1_スケジュール実行フォルダの中のoutputフォルダに、"output.xlsx"が出力される。このファイルには、上述したシートの他に、「全体スケジュール」というシートが出力されている。生徒ごとに、ある日のある時限に、どの科目の誰先生の授業があるのかが書かれている。

- 未定の先生がいた場合  
２通りの対処法が考えられる。  
    - 手作業で入力する
    その生徒と希望の先生のスケジュールが空いていた場合、「全体スケジュール」のセルの中に、先生の名前を記入する。その際、その先生と生徒のその日付時限のスケジュールを0にすることを忘れないようにする。

    - もう一度自動で組み直す
    そのセルを0にして、「生徒_受講コマ数」シートへ移動する。すべての欄が0になっていると思うので、削除した科目の欄へその科目を消した個数を記入し、希望する先生を入力する。そして、output.xlsxになっていると思うが、ファイル名をinput.xlsxとして、inputフォルダへおき、もう一度スケジュールを実行する。最初に実行したinput.xlsxファイルは、ファイル名を任意の名前に変えて、そのフォルダへおいておけば良い。

- スケジュールが連続しすぎた場合
    そのセルを0にして、「生徒_受講コマ数」シートへ移動する。すべての欄が0になっていると思うので、削除した科目の欄へその科目を消した個数を記入し、希望する先生を入力する。そして、output.xlsxになっていると思うが、ファイル名をinput.xlsxとして、inputフォルダへおき、もう一度スケジュールを実行する。最初に実行したinput.xlsxファイルは、ファイル名を任意の名前に変えて、そのフォルダへおいておけば良い。

- 振替をする場合
２通りの対処法が考えられる。  
    - 手作業で入力する
    その生徒と希望の先生のスケジュールが空いていた場合、「全体スケジュール」のセルの中に、先生の名前を記入する。その際、その先生と生徒のその日付時限のスケジュールを0にすることを忘れないようにする。

    - もう一度自動で組み直す
    そのセルを0にして、「生徒_受講コマ数」シートへ移動する。すべての欄が0になっていると思うので、削除した科目の欄へその科目を消した個数を記入し、希望する先生を入力する。そして、output.xlsxになっていると思うが、ファイル名をinput.xlsxとして、inputフォルダへおき、もう一度スケジュールを実行する。最初に実行したinput.xlsxファイルは、ファイル名を任意の名前に変えて、そのフォルダへおいておけば良い。


